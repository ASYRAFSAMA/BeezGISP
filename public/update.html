<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Product</title>
    <link rel="stylesheet" href="update.css">
</head>
<body>
    <div id="updateFormContainer">
        <h2>Update Product</h2>
        <form id="updateProductForm">
            <input type="hidden" id="updateProductId">
            <input type="text" id="updateProductName" name="productName" placeholder="Enter product name" required>
            <input type="number" id="updateProductQuantity" name="productQuantity" placeholder="Enter product quantity" required>
            <input type="number" id="updateProductPrice" name="productPrice" placeholder="Enter product price" required>
            <button type="submit">Update Product</button>
        </form>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', async () => {
          const urlParams = new URLSearchParams(window.location.search);
          const productId = urlParams.get('productId');

          if (productId) {
              try {
                  const response = await fetch(`/product/${productId}`);
                  const product = await response.json();

                  document.getElementById('updateProductId').value = product.productid;
                  document.getElementById('updateProductName').value = product.productname;
                  document.getElementById('updateProductQuantity').value = product.productquantity;
                  document.getElementById('updateProductPrice').value = product.productprice;
              } catch (error) {
                  console.error('Error fetching product:', error);
              }
          }

          document.getElementById('updateProductForm').addEventListener('submit', async function(event) {
              event.preventDefault();
              const productId = document.getElementById('updateProductId').value;
              const productName = document.getElementById('updateProductName').value;
              const productQuantity = document.getElementById('updateProductQuantity').value;
              const productPrice = document.getElementById('updateProductPrice').value;

              try {
                  const response = await fetch(`/update-product/${productId}`, {
                      method: 'PUT',
                      headers: {
                          'Content-Type': 'application/json'
                      },
                      body: JSON.stringify({ productName, productQuantity, productPrice })
                  });

                  if (response.ok) {
                      alert('Product updated successfully!');
                      window.location.href = 'product.html';
                  } else {
                      alert('Failed to update product.');
                  }
              } catch (error) {
                  console.error('Error updating product:', error);
                  alert('Error updating product.');
              }
          });
      });
    </script>
</body>
</html>
